---
import { getCollection, getEntry } from 'astro:content';

export async function getStaticPaths() {
  const posts = await getCollection('posts');
  return posts.map((post) => ({
    params: { slug: post.id },
  }));
}

export async function get({ params }: { params: { slug: string } }) {
  const post = await getEntry('posts', params.slug);
  if (!post) {
    return new Response(null, { status: 404 });
  }
  return {
    props: { post }
  };
}

const { post } = Astro.props;
---

<article>
  <h1>{post.data.title}</h1>
  <p>By {post.data.author}</p>
  {post.data.cover && <img src={post.data.cover} alt="Cover image" />}
  <Markdown content={post.body} />
</article>